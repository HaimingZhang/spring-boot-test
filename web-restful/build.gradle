apply plugin: "application"
apply plugin: 'spring-boot'
apply plugin: 'docker'

repositories {
    mavenCentral()
}

jar {
    baseName = 'web-restful'
    version = '1.0.0'
}

run {
    mainClassName = 'com.hemming.web.Application'
}

task buildDocker(type: Docker, dependsOn: build) {
    dockerfile = file('src/main/resources/Dockerfile')
    doFirst {
        copy {
            from jar
            into stageDir
        }
    }
}

dependencies {

    compile("org.springframework.boot:spring-boot-starter-web")

    compile('org.mybatis.spring.boot:mybatis-spring-boot-starter:1.1.1') {
        exclude group: 'org.apache.tomcat', module: 'tomcat-jdbc'
    }

    compile('org.springframework.boot:spring-boot-starter-aop:1.5.18.RELEASE')

    compile('com.zaxxer:HikariCP:2.4.7')
    compile "javax.validation:validation-api:1.1.0.Final"
    compile "org.hibernate:hibernate-validator:5.3.6.Final"

    compile 'com.alibaba:fastjson:1.2.39'

    runtime('mysql:mysql-connector-java')

    testCompile('org.springframework.boot:spring-boot-starter-test')
}